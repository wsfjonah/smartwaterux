{"version":3,"sources":["app.js","config.js","services.js","directives.js","factory.js","filter.js","authCtrl.js"],"names":["env","window","Object","assign","__env","app","angular","module","constant","controller","$scope","$translate","authService","$location","$rootScope","$window","vm","this","flag_path","folder","default_userInfo","username","token","role","projects","current_project","name","timezone","lang","apps","flag_img","en","cn","lang_trans","currLang","$on","xpro","initPageLoadedLibrary","resizeHeader","userInfo","getAuthentication","$watch","layoutViewClass","isDefined","page_key","isCurrentPath","path","changeLanguage","key","use","$$path","location","reload","isAuthenticated","isLoggedIn","switchProject","projectId","then","response","data","updateProject","opts","extend","console","log","getProjectUpdate","logout","event","language","run","currRoute","page_params","restrictions","ensureAuthenticated","config","$httpProvider","$translateProvider","$qProvider","errorOnUnhandledRejections","interceptors","push","defaults","headers","get","useStaticFilesLoader","prefix","localeFolderUrl","suffix","preferredLanguage","useLocalStorage","useSanitizeValueStrategy","factory","$q","$injector","localStorageService","authInterceptorServiceFactory","request","authData","ignore_url","ignoreInterceptorRequest","indexOf","url","params","responseError","rejection","status","xhrStatus","reject","$routeProvider","when","templateUrl","loginRedirect","resolve","loadMyCtrl","$ocLazyLoad","load","serie","files","controllerAs","otherwise","redirectTo","$http","$httpParamSerializerJQLike","_authentication_info","isAuth","login","user","method","userLoginUrl","Content-Type","projectid","switchProjectUrl","res","opts_res","set","setAuthentication","user_info","isToken","auth_res","apiService","apiBaseURL","baseUrl","Pragma","undefined","Cache-Control","X-Requested-With","If-Modified-Since","siteApi","string","configArr","timeSeriesAnyApi","id","timeSeriesAnyUrl","timeSeriesHighRateApi","from","to","timeSeriesRangeApi","datapointId","resolution","timeSeriesRangeUrl","eventAnyApi","eventAnyUrl","eventDurationApi","eventDurationUrl","duration","eventRangeApi","eventRangeUrl","eventDetailsApi","eventId","eventDetailsUrl","boundaryApi","heatMapApi","sensorApi","query","pipeApi","service","$inject","canvasAction","elem","$","chartElem","find","addClass","min","max","hide","show","togglePan","btnElem","isTrigger","panElem","toolbar","value","panActive","hasClass","click","removeClass","attr","destroyTooltip","tooltips","elemReady","$parse","restrict","link","attrs","ready","$apply","func","projectDropdown","scope","options","template","switch","_id","pageMain","xproMap","modalService","mapApi","replace","info","onMapLoaded","topHt","outerHeight","css","height","resize","initialize","navCtrl","scaleCtrl","overviewCtrl","enableScrollWheelZoom","enableAutoResize","zoom","mapType","fullScreen","map","createMapInstance","previousMarkers","redrawMarkers","boundaryArea","xproHeatmap","pipes","forEach","row","pipeArr","loc","pt","BMap","Point","longitude","latitude","pipeOverlay","Polyline","strokeColor","color","strokeWeight","weight","strokeOpacity","addOverlay","drawPipeArea","newValue","length","addEventListener","drawHeatMap","deferred","defer","initMap","script","document","createElement","src","body","appendChild","loadScript","promise","heatmapApi","fullscreenControl","defaultAnchor","BMAP_ANCHOR_TOP_RIGHT","defaultOffset","Size","toggleHeatMapButtons","element","Map","centerAndZoom","center","addControl","NavigationControl","setCurrentCity","city","prototype","Control","zoomBtn","className","zoomIcon","onclick","getContainer","myZoomCtrl","createFullScreen","div","setAttribute","labelHeatMap","chkHeatMap","type","append","innerHTML","instant","labelPipe","chkPipe","labelMarker","chkMarker","onchange","isOn","getElementById","checked","heatmapOverlay","allOverlay","getOverlays","i","toString","myCtrl","createHeatMapButtons","points","num","Math","ceil","boundary","polygon","Polygon","fillColor","setViewport","moveMapToCenter","getContext","isSupportCanvas","removeEventListener","BMapLib","HeatmapOverlay","radius","setDataSet","heatMap","item","marker","listener","removeOverlay","markers","markerItem","point","icon","Icon","width","anchor","Marker","createMarker","infoButton","setLabel","previousMarker","title","content","msg","infoWindowItem","InfoWindow","enableMessage","openInfoWindow","elData","elInfo","open","modalUrl","modalCtrl","modalUrlInfo","modalCtrlInfo","directive","default_opts","on","oldValue","$mdDialog","dialogService","alert","ev","opt_config","ok","parent","querySelector","clickOutsideToClose","textContent","ariaLabel","targetEvent","$uibModal","modalInstance","ctrl","size","items","result","selectedItem","selected","filter","object","equals","$sce","version","assetVersion","trustAsResourceUrl","authLoginController","onLogin","catch"],"mappings":"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","file":"angular-app.min.js","sourcesContent":["/* global angular, xpro, __env */\n'use strict';\nvar env = {};\n// Import variables if present (from env.js)\nif(window){\n\tObject.assign(env, window.__env);\n}\nvar app = angular\n\t.module('xProject', [\n\t\t'ngMaterial',\n\t\t'pascalprecht.translate',\n\t\t'ngRoute',\n\t\t'ngCookies',\n\t\t'LocalStorageModule',\n\t\t'xProject.config',\n\t\t'xProject.directive',\n\t\t'xProject.factory',\n\t\t'xProject.filter',\n\t\t'xProject.services',\n\t\t'xProject.auth'\n\t]);\n\napp.constant('__env', env);\napp.controller('layoutCtrl', function layoutCtrl ($scope, $translate, authService, $location, $rootScope, $window) {\n\tvar vm = this;\n\tvar flag_path = __env.folder+\"/assets/img/flags/\";\n\tvar default_userInfo = {\n\t\tusername: \"\",\n\t\ttoken: \"\",\n\t\trole: \"\",\n\t\tprojects:[],\n\t\tcurrent_project: {\n\t\t\tname: \"\"\n\t\t},\n\t\ttimezone: \"\",\n\t\tlang: \"\",\n\t\tapps: {}\n\t};\n\tvm.flag_img = {\n\t\t\"en\" : flag_path+\"US.png\",\n\t\t\"cn\" : flag_path+\"CN.png\"\n\t};\n\n\tvm.lang_trans = {\n\t\t\"en\" : \"us\",\n\t\t\"cn\" : \"cn\"\n\t};\n\n\tvm.currLang = vm.flag_img[$rootScope.lang];\n\n\t$scope.$on('$includeContentLoaded', function (/*event, target*/) {\n\t\txpro.initPageLoadedLibrary();\n\t});\n\n\t$scope.$on('$viewContentLoaded', function(){\n\t\txpro.resizeHeader();\n\t});\n\n\tvm.userInfo = authService.getAuthentication();\n\t/* watching authService.getAuthentication() to get the user info\n\t*/\n\t$scope.$watch(function() { return authService.getAuthentication(); }, function(/*newVal*/) {\n\t\tvm.userInfo = authService.getAuthentication();\n\t}, true);\n\n\tvm.layoutViewClass = function() {\n\t\treturn (angular.isDefined($rootScope.page_key) && $rootScope.page_key===\"login\") ? \"layout-login\" : \"\";\n\t};\n\n\tvm.isCurrentPath = function (path) {\n\t\treturn $location.path() == path;\n\t};\n\n\tvm.changeLanguage = function (key) {\n\t\t$translate.use(key);\n\t\tif($location.$$path===\"/site\"){\n\t\t\t$window.location.reload();\n\t\t}\n\t};\n\tvm.isAuthenticated = function() {\n\t\treturn authService.isLoggedIn();\n    \t};\n    \tvm.switchProject = function(projectId){\n    \t\tauthService.switchProject(projectId).then(function(response){\n    \t\t\tif(angular.isDefined(response.data.token)){\n    \t\t\t\tauthService.updateProject(response.data);\n    \t\t\t\tgetProjectUpdate();\n    \t\t\t\t//vm.projectName = projectId;\n    \t\t\t}\n    \t\t});\n    \t};\n    \tvm.logout = function () {\n    \t\tvm.userInfo = angular.extend({}, vm.userInfo, default_userInfo);\n\t\tauthService.logout();\n\t\t$location.path('/login');\n\t};\n\t$rootScope.$on('$translateChangeSuccess', function(event, data) {\n\t\t$rootScope.lang = data.language;\n\t\tvm.currLang = vm.lang_trans[data.language];//vm.flag_img[data.language];\n\t});\n\n\tfunction getProjectUpdate(){\n\t\tvar opts = authService.getAuthentication();\n\t\tvm.userInfo = angular.extend({}, default_userInfo, opts);\n\t\tconsole.log(vm.userInfo);\n\t}\n});\n\napp.run(['$rootScope', '$location', 'authService', function ($rootScope, $location, authService) {\n\t$rootScope.lang = 'en';\n\t$rootScope.page_key = '';\n\t$rootScope.$on('$routeChangeStart', function (event, currRoute/*, prevRoute*/) {\n\t\tif(angular.isDefined(currRoute.page_params) && angular.isDefined(currRoute.page_params.key)){\n\t\t\t$rootScope.page_key = currRoute.page_params.key;\n\t\t}\n\t\tif(angular.isDefined(currRoute.restrictions) && currRoute.restrictions.ensureAuthenticated){\n\t\t\tvar user_info = authService.isLoggedIn();\n\t\t\tif(!user_info){\n\t\t\t\tauthService.logout();\n\t\t\t\t$location.path('/login');\n\t\t\t}\n\t\t}\n\t});\n}]);\n\napp.config(function ($httpProvider, $translateProvider, $qProvider) {\n\t$qProvider.errorOnUnhandledRejections(false);\n\t$httpProvider.interceptors.push('authInterceptorService');\n\n\t//no cache\n\tif(!angular.isDefined($httpProvider.defaults.headers.get)){\n\t\t$httpProvider.defaults.headers.get = {};\n\t}\n\t$httpProvider.defaults.headers.get['Cache-Control'] = 'no-cache';\n\t$httpProvider.defaults.headers.get['Pragma'] = 'no-cache';\n\n\t//translation\n\t$translateProvider\n\t\t.useStaticFilesLoader({\n\t\t\tprefix: __env.localeFolderUrl,\n\t\t\tsuffix: '.json'\n\t\t})\n\t\t.preferredLanguage('en')\n\t\t.useLocalStorage()\n\t\t.useSanitizeValueStrategy('escapeParameters'); //without this. warning msg from angularjs about security issue\n\n});\n\napp.factory('authInterceptorService', ['$q', '$injector','$location', 'localStorageService', function ($q, $injector,$location, localStorageService) {\n\tvar authInterceptorServiceFactory = {};\n\tvar _request = function (config) {\n\t\tconfig.headers = config.headers || {};\n\t\tvar authData = localStorageService.get('authorizationData');\n\t\tvar ignore_url = __env.ignoreInterceptorRequest;\n\t\tif(authData!==null){\n\t\t\tif(angular.isDefined(authData.token) && ignore_url.indexOf(config.url)<0) {\n\t\t\t\tconfig.params = {'token': authData.token};\n\t\t\t}\n\t\t}\n\t\treturn config;\n\t};\n\tvar _responseError = function (rejection) {\n\t\tconsole.log('##rejection');\n\t\tif (rejection.status === 401 || rejection.status === -1 && rejection.xhrStatus!==\"abort\") {//xhrStatus trick\n\t\t\tvar authService = $injector.get('authService');\n\t\t\tauthService.logout();\n\t\t\t$location.path('/login');\n\t\t}\n\t\treturn $q.reject(rejection);\n\t};\n\tauthInterceptorServiceFactory.request = _request;\n\tauthInterceptorServiceFactory.responseError = _responseError;\n\treturn authInterceptorServiceFactory;\n}]);","/* global angular */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.config', ['oc.lazyLoad'])\n\t\t.config(appConfig);\n\n\tfunction appConfig($routeProvider) {\n\t\t$routeProvider\n\t\t.when('/main', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/main/main.html',\n\t\t\tcontroller: 'mainController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"dashboard\"\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load({\n\t\t\t\t\t\tserie: true,\n\t\t\t\t\t\tfiles: [\n\t\t\t\t\t\t\t'assets/js/plugins/sparkline/jquery.sparkline.min.js',\n\t\t\t\t\t\t\t'assets/js/plugins/chartist-js/dist/chartist.min.css',\n\t\t\t\t\t\t\t'assets/js/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.css',\n\t\t\t\t\t\t\t'assets/js/plugins/chartist-js/dist/chartist.min.js',\n\t\t\t\t\t\t\t'assets/js/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.min.js',\n\t\t\t\t\t\t\t'assets/js/xpro_dashboard.js',\n\t\t\t\t\t\t\t'app/modules/main/mainCtrl.js'\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}]\n\t\t\t}\n\t\t})\n\t\t.when('/location', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/remote/location.html',\n\t\t\tcontroller: 'locationController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"location\"\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load({\n\t\t\t\t\t\tserie: true,\n\t\t\t\t\t\tfiles: [\n\t\t\t\t\t\t\t'app/vendors/angular-daterangepicker.min.js',\n\t\t\t\t\t\t\t'app/modules/remote/locationCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalEventDetailsCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalTimeSeriesCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalHighRateCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalDetailsCtrl.js'\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}]\n\t\t\t},\n\t\t})\n\t\t.when('/site', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/remote/site.html',\n\t\t\tcontroller: 'siteTableController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load({\n\t\t\t\t\t\tserie: true,\n\t\t\t\t\t\tfiles: [\n\t\t\t\t\t\t\t'assets/css/bootstrap-table.css',\n\t\t\t\t\t\t\t'assets/js/bootstrap-table.min.js',\n\t\t\t\t\t\t\t'app/vendors/bootstrap-table-angular.min.js',\n\t\t\t\t\t\t\t'assets/js/locale/bootstrap-table-zh-CN.min.js',\n\t\t\t\t\t\t\t'assets/js/locale/bootstrap-table-en-US.min.js',\n\t\t\t\t\t\t\t'app/vendors/angular-daterangepicker.min.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalEventDetailsCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalTimeSeriesCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalHighRateCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalDetailsCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/modalMapCtrl.js',\n\t\t\t\t\t\t\t'app/modules/remote/siteTableCtrl.js'\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}]\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"site\"\n\t\t\t},\n\t\t})\n\t\t.when('/gis', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/network/gis.html',\n\t\t\tcontroller: 'gisController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load({\n\t\t\t\t\t\tserie: true,\n\t\t\t\t\t\tfiles: [\n\t\t\t\t\t\t\t'app/modules/network/gisCtrl.js'\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\t\t\t\t}]\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"gis\"\n\t\t\t}\n\t\t})\n\t\t.when('/network-condition', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/network/netcondition.html',\n\t\t\tcontroller: 'networkCondtionController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load([\n\t\t\t\t\t\t'app/modules/network/netconditionCrtl.js'\n\t\t\t\t\t]);\n\t\t\t\t}]\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"network_condition\"\n\t\t\t}\n\t\t})\n\t\t.when('/network-alert', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/network/netalert.html',\n\t\t\tcontroller: 'networkAlertController as vm',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: true,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tresolve: {\n\t\t\t\tloadMyCtrl: ['$ocLazyLoad', function($ocLazyLoad) {\n\t\t\t\t\treturn $ocLazyLoad.load([\n\t\t\t\t\t\t'app/modules/network/netalertCtrl.js'\n\t\t\t\t\t]);\n\t\t\t\t}]\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"network_alert\"\n\t\t\t}\n\t\t})\n\t\t.when('/login', {\n\t\t\ttemplateUrl: __env.folder+'/app/modules/auth/login.html',\n\t\t\tcontroller: 'authLoginController',\n\t\t\tcontrollerAs: 'authLoginCtrl',\n\t\t\trestrictions: {\n\t\t\t\tensureAuthenticated: false,\n\t\t\t\tloginRedirect: false\n\t\t\t},\n\t\t\tpage_params: {\n\t\t\t\tkey: \"login\"\n\t\t\t},\n\t\t}).otherwise({\n\t\t\tredirectTo: '/main'\n\t\t});\n\t}\n})();","/* global angular, __env */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.services', [])\n\t\t.service('authService', authService)\n\t\t.service('apiService', apiService);\n\n\tauthService.$inject = ['$http','localStorageService','$httpParamSerializerJQLike'];\n\tapiService.$inject = ['$http','localStorageService','$httpParamSerializerJQLike'];\n\n\tfunction authService($http, localStorageService, $httpParamSerializerJQLike) {\n\t\tvar _authentication_info = { //default object\n\t\t\tisAuth: false,\n\t\t\tusername: \"\",\n\t\t\ttoken: \"\",\n\t\t\trole: \"\",\n\t\t\tprojects:[],\n\t\t\tcurrent_project: {\n\t\t\t\tname: \"\"\n\t\t\t},\n\t\t\ttimezone: \"\",\n\t\t\tlang: \"\",\n\t\t\tapps: {}\n\t\t};\n\t\t/*jshint validthis: true */\n\t\tthis.login = function(user) {\n\t\t\treturn $http({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: __env.userLoginUrl,\n\t\t\t\tdata: $httpParamSerializerJQLike(user),\n\t\t\t\theaders: {'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'} //due to xproject backend required this\n\t\t\t\t//headers: {'Content-Type': 'application/json'} //application/json\n\t\t\t});\n\t\t};\n\t\tthis.switchProject = function(projectId){\n\t\t\tvar params = {projectid: projectId, token: this.getAuthentication().token};\n\t\t\treturn $http({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: __env.switchProjectUrl,\n\t\t\t\tdata: $httpParamSerializerJQLike(params),\n\t\t\t\theaders: {'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'}\n\t\t\t});\n\t\t};\n\t\tthis.updateProject = function(res){\n\t\t\tvar opts_res = angular.extend({}, this.getAuthentication(), res);\n\t\t\tif(angular.isDefined(res.token) && res.token!==\"\"){\n\t\t\t\topts_res.isAuth = true;\n\t\t\t}\n\t\t\tlocalStorageService.set('authorizationData', opts_res);\n\t\t};\n\t\t/*this.ensureAuthenticated = function(token) { //unused for now\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: userBaseURL + 'user',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\tAuthorization: 'Bearer ' + token\n\t\t\t\t}\n\t\t\t});\n\t\t};*/\n\t\tthis.setAuthentication = function(res){\n\t\t\tvar opts_res = angular.extend({}, _authentication_info, res);\n\t\t\tif(angular.isDefined(res.token) && res.token!==\"\"){\n\t\t\t\topts_res.isAuth = true;\n\t\t\t}\n\t\t\t//console.log('#set authorizationData');\n\t\t\t//console.log(opts_res);\n\t\t\tlocalStorageService.set('authorizationData', opts_res);\n\t\t\tthis.getAuthentication();\n\t\t};\n\t\tthis.isLoggedIn = function(){\n\t\t\tvar user_info = this.getAuthentication();\n\t\t\tvar isAuth = (angular.isDefined(user_info.isAuth) && user_info.isAuth);\n\t\t\tvar isToken = (angular.isDefined(user_info.token) && user_info.token!==\"\");\n\t\t\treturn (isAuth && isToken);\n\t\t};\n\t\tthis.getAuthentication = function(){\n\t\t\tvar auth_res = localStorageService.get('authorizationData');\n\t\t\tif(auth_res===null){\n\t\t\t\tauth_res = _authentication_info;\n\t\t\t}\n\t\t\treturn auth_res;\n\t\t};\n\t\tthis.logout = function(){\n\t\t\tlocalStorageService.set('authorizationData', _authentication_info);\n\t\t\tthis.updateProject(_authentication_info);\n\t\t\t//console.log('#logout');\n\t\t\t//console.log(_authentication_info);\n\t\t};\n\t}\n\n\tfunction apiService($http, localStorageService, $httpParamSerializerJQLike){\n\t\tvar apiBaseURL = __env.baseUrl;\n\t\tvar headers = {'Pragma': undefined, 'Cache-Control': undefined, 'X-Requested-With': undefined, 'If-Modified-Since': undefined, 'Content-Type': 'application/json'};\n\t\t//var headers = {'Content-Type': 'application/json'};\n\t\t/*jshint validthis: true */\n\t\tthis.siteApi = function(string){\n\t\t\tvar configArr = {\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: apiBaseURL + 'site/search',\n\t\t\t\theaders: headers,\n\t\t\t\tdata: $httpParamSerializerJQLike()\n\t\t\t};\n\t\t\tif(typeof string!==\"undefined\" && string!==\"\"){\n\t\t\t\tconfigArr.url = configArr.url+\"?query=\"+string;\n\t\t\t}\n\t\t\treturn $http(configArr);\n\t\t};\n\n\t\tthis.timeSeriesAnyApi = function(id){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.timeSeriesAnyUrl+\"/\"+id+\"/any\",\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.timeSeriesHighRateApi = function(res){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.timeSeriesAnyUrl+\"/\"+res.id+\"/highrate/\"+res.from+\"/\"+res.to,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.timeSeriesRangeApi = function(datapointId, resolution,  from, to){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.timeSeriesRangeUrl+\"/\"+datapointId+\"/\"+resolution+\"/\"+from+\"/\"+to,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.eventAnyApi = function(){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.eventAnyUrl,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.eventDurationApi = function(res){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.eventDurationUrl+\"/\"+res.to+\"/\"+res.duration,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.eventRangeApi = function(from, to){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.eventRangeUrl+\"/\"+from+\"/\"+to,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.eventDetailsApi = function(eventId){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: __env.eventDetailsUrl+\"/\"+eventId,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.boundaryApi = function(){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: apiBaseURL + 'map/boundary',\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\n\t\tthis.heatMapApi = function(){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: apiBaseURL + 'map/heatmap',\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\t\tthis.sensorApi = function(query){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: apiBaseURL + 'map/sensorjunction?query='+query,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\t\tthis.pipeApi = function(query){\n\t\t\treturn $http({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: apiBaseURL + 'map/pipe?query='+query,\n\t\t\t\theaders: headers\n\t\t\t});\n\t\t};\n\t}\n})();","/* global angular, BMap, xpro, __env, BMapLib, BMAP_ANCHOR_TOP_RIGHT */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.directive', ['ui.bootstrap'])\n\t\t.directive('xproMap', xproMap)\n\t\t.directive('xproHeatmap', xproHeatmap)\n\t\t.directive('projectDropdown', projectDropdown)\n\t\t.directive('canvasToolbar', canvasToolbar)\n\t\t.directive('elemReady', elemReady)\n\t\t.service('mapApi', mapApi)\n\t\t.service('heatmapApi', heatmapApi);\n\n\t//global defined\n\tvar heatmapOverlay;\n\n\tfunction canvasToolbar(){\n\t\treturn {\n\t\t\trestrict: 'AE',\n\t\t\tscope: {\n\t\t\t\toptions: '='\n\t\t\t},\n\t\t\ttemplate: '<div class=\"btn-group\" role=\"group\"><button type=\"button\" class=\"btn btn-secondary\" data-state=\"pan\" data-value=\"pan\" data-toggle=\"tooltip\" title=\"Pan Move\"><i class=\"ti-split-h\"></i></button><button type=\"button\" class=\"btn btn-secondary\" data-state=\"reset\" data-toggle=\"tooltip\" title=\"Reset Zoom\"><i class=\"ti-close\"></i></button></div>',\n\t\t\tlink: function (scope, elem) {\n\t\t\t\tvar default_opts = {\n\t\t\t\t\tchartElem: null,\n\t\t\t\t\tmin: 0,\n\t\t\t\t\tmax: 0\n\t\t\t\t};\n\t\t\t\tvar opts = angular.extend({}, default_opts, scope.options);\n\n\t\t\t\tcanvasAction(elem, opts);\n\t\t\t\telem.on('click','button[data-state=\"pan\"]',function(){\n\t\t\t\t\ttogglePan($(this), opts);\n\t\t\t\t});\n\t\t\t\telem.on('click','button[data-state=\"reset\"]',function(){\n\t\t\t\t\tvar toolbar = $('#'+opts.chartElem).find('.canvasjs-chart-toolbar');\n\t\t\t\t\ttoolbar.find('button[state=\"reset\"]').click();\n\t\t\t\t\txpro.destroyTooltip();\n\t\t\t\t});\n\t\t\t\tscope.$watch('options', function(newValue, oldValue) {\n\t\t\t\t\tif (newValue !== oldValue) {\n\t\t\t\t\t\topts = angular.extend({}, default_opts, newValue);\n\t\t\t\t\t\tcanvasAction(elem, opts);\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t}\n\t\t};\n\t}\n\tfunction canvasAction(elem, opts){\n\t\tvar chart = $('#'+opts.chartElem);\n\t\tchart.find('.canvasjs-chart-toolbar').addClass('hide');\n\t\tif(opts.min<=0 && opts.max<=0){\n\t\t\t$(elem).hide();\n\t\t}else{\n\t\t\t$(elem).show();\n\t\t}\n\t\ttogglePan($(elem).find('[data-state=\"pan\"]'), opts, true);\n\t}\n\tfunction togglePan(btnElem, opts, isTrigger){\n\t\tvar panElem = btnElem,\n\t\ttoolbar = $('#'+opts.chartElem).find('.canvasjs-chart-toolbar'),\n\t\tvalue = panElem.data('value'),\n\t\tpanActive = panElem.hasClass('isactive');\n\n\t\tif(typeof isTrigger!==\"undefined\" && isTrigger){\n\t\t\tif(value===\"pan\"){\n\t\t\t\ttoolbar.find('button[state=\"zoom\"]').click();\n\t\t\t}else if(value===\"zoom\"){\n\t\t\t\ttoolbar.find('button[state=\"pan\"]').click();\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif(panActive){\n\t\t\ttoolbar.find('button[state=\"zoom\"]').click();\n\t\t\tpanElem.data('original-title', 'Pan Move').data('value','pan').removeClass('isactive').find('i').attr('class','ti-split-h');\n\t\t}else{\n\t\t\ttoolbar.find('button[state=\"pan\"]').click();\n\t\t\tpanElem.data('original-title','Zoom').data('value','zoom').addClass('isactive').find('i').attr('class','ti-zoom-in');\n\t\t}\n\t\txpro.destroyTooltip();\n\t\txpro.tooltips();\n\t}\n\n\t/* get dom ready\n\t*/\n\telemReady.$inject = ['$parse'];\n\tfunction elemReady($parse){\n\t\treturn {\n\t\t\trestrict: 'A',\n\t\t\tlink: link\n\t\t};\n\t\tfunction link($scope, elem, attrs){\n\t\t\telem.ready(function(){\n\t\t\t\t$scope.$apply(function(){\n\t\t\t\t\tvar func = $parse(attrs.elemReady);\n\t\t\t\t\tfunc($scope);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/* switching project from dropdown\n\t*/\n\tprojectDropdown.$inject = ['authService','$location'];\n\tfunction projectDropdown(authService,$location){\n\t\treturn {\n\t\t\trestrict: 'E',\n\t\t\tscope: {\n\t\t\t\toptions: '='\n\t\t\t},\n\t\t\ttemplate: '<a href=\"JavaScript:void(0);\" class=\"dropdown-item\" ng-repeat=\"(key, val) in data.projects\" ng-class=\"{active : data.current_project._id == key}\" ng-click=\"switch(key)\">{{ val }}</a>',\n\t\t\tcontroller: function ($scope) {\n\t\t\t\t$scope.data = $scope.options;\n\t\t\t\t$scope.switch = function(key){\n\t\t\t\t\tif(key!==$scope.data.current_project._id){\n\t\t\t\t\t\tauthService.switchProject(key).then(function(response){\n\t\t\t\t    \t\t\tif(angular.isDefined(response.data.token)){\n\t\t\t\t    \t\t\t\tauthService.updateProject(response.data);\n\t\t\t\t    \t\t\t\t$scope.data = response.data;\n\t\t\t\t    \t\t\t\t$location.path(__env.pageMain);\n\t\t\t\t    \t\t\t}\n\t\t\t\t    \t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n\n\t//xproMap.$inject = [];\n\t/* baidu map\n\t*/\n\txproMap.$inject = ['modalService','mapApi'];\n\tfunction xproMap(modalService, mapApi) {\n\t\treturn{\n\t\t\trestrict: 'AE',\n\t\t\treplace: 'true',\n\t\t\tscope:{\n\t\t\t\tinfo: '@',\n\t\t\t\toptions: '=',\n\t\t\t\tonMapLoaded: '&'\n\t\t\t},\n\t\t\tlink: function(scope, elem/*, attrs*/) {\n\t\t\t\tvar topHt = $('.topbar').outerHeight();\n\t\t\t\telem.css('height',$(window).height()-topHt);\n\t\t\t\t$(window).resize(function(){\n\t\t\t\t\telem.css('height',$(window).height()-topHt);\n\t\t\t\t});\n\n\t\t\t\tscope.initialize = function() {\n\t\t\t\t\tvar default_opts = {\n\t\t\t\t\t\tnavCtrl: true,\n\t\t\t\t\t\tscaleCtrl: true,\n\t\t\t\t\t\toverviewCtrl: true,\n\t\t\t\t\t\tenableScrollWheelZoom: true,\n\t\t\t\t\t\tenableAutoResize: true,\n\t\t\t\t\t\tzoom: 10,\n\t\t\t\t\t\tmapType: \"map\",\n\t\t\t\t\t\tfullScreen: false\n\t\t\t\t\t};\n\t\t\t\t\tvar opts = angular.extend({}, default_opts, scope.options);\n\t\t\t\t\tvar map = createMapInstance(opts, elem);\n\t\t\t\t\tvar previousMarkers = [];\n\n\t\t\t\t\t//create markers\n\t\t\t\t\tredrawMarkers(map, previousMarkers, opts, scope, modalService);\n\t\t\t\t\t//set boundary\n\t\t\t\t\tboundaryArea(map, opts);\n\n\t\t\t\t\tscope.$watch('options.markers', function (/*newValue, oldValue*/) {\n\t\t\t\t\t\tredrawMarkers(map, previousMarkers, opts, scope, modalService);\n\t\t\t\t\t}, true);\n\t\t\t\t\tscope.$watch('options.boundary', function (/*newValue, oldValue*/) {\n\t\t\t\t\t\tboundaryArea(map, opts, scope);\n\t\t\t\t\t}, true);\n\t\t\t\t};\n\t\t\t\tmapApi.then(function () {\n\t\t\t\t\tscope.initialize();\n\t\t\t\t}, function () {\n\t\t\t\t\t// Promise rejected\n\t\t\t\t});\n\n\t\t\t},\n\t\t\ttemplate: '<div ng-style=\"divStyle\"><label ng-style=\"labelStyle\"></label></div>'\n\t\t};\n\t}\n\n\t/* baidu heatmap\n\t*/\n\txproHeatmap.$inject = ['$translate','mapApi'];\n\tfunction xproHeatmap($translate, mapApi){\n\t\treturn{\n\t\t\trestrict: 'AE',\n\t\t\treplace: 'true',\n\t\t\tscope:{\n\t\t\t\tinfo: '@',\n\t\t\t\toptions: '=',\n\t\t\t\tonMapLoaded: '&'\n\t\t\t},\n\t\t\tlink: function(scope, elem/*, attrs*/) {\n\t\t\t\tvar topHt = $('.topbar').outerHeight();\n\t\t\t\telem.css('height',$(window).height()-topHt);\n\t\t\t\t$(window).resize(function(){\n\t\t\t\t\telem.css('height',$(window).height()-topHt);\n\t\t\t\t});\n\n\t\t\t\tscope.initialize = function() {\n\t\t\t\t\tvar default_opts = {\n\t\t\t\t\t\tnavCtrl: true,\n\t\t\t\t\t\tscaleCtrl: true,\n\t\t\t\t\t\toverviewCtrl: true,\n\t\t\t\t\t\tenableScrollWheelZoom: true,\n\t\t\t\t\t\tzoom: 10,\n\t\t\t\t\t\tmapType: \"heatmap\",\n\t\t\t\t\t\tfullScreen: false\n\t\t\t\t\t};\n\t\t\t\t\tvar opts = angular.extend({}, default_opts, scope.options);\n\t\t\t\t\tvar map = createMapInstance(opts, elem, $translate);\n\t\t\t\t\tvar previousMarkers = [];\n\t\t\t\t\t//create markers\n\t\t\t\t\tredrawMarkers(map, previousMarkers, opts, scope);\n\n\n\t\t\t\t\t//watch markers\n\t\t\t\t\tscope.$watch('options.markers', function (/*newValue, oldValue*/) {\n\t\t\t\t\t\tredrawMarkers(map, previousMarkers, opts, scope);\n\t\t\t\t\t}, true);\n\t\t\t\t\t//watch pipe\n\t\t\t\t\tscope.$watch('options.pipes', function (/*newValue, oldValue*/) {\n\t\t\t\t\t\tdrawPipeArea(map, opts, scope);\n\t\t\t\t\t}, true);\n\t\t\t\t\t//watch heatmap\n\t\t\t\t\tscope.$watch('options.heatMap', function (newValue/*, oldValue*/) {\n\t\t\t\t\t\tif(newValue.length){\n\t\t\t\t\t\t\tmap.addEventListener(\"tilesloaded\",drawHeatMap(map, opts));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\t\t\t\t};\n\t\t\t\tmapApi.then(function () {\n\t\t\t\t\tscope.initialize();\n\t\t\t\t}, function () {\n\t\t\t\t\t// Promise rejected\n\t\t\t\t});\n\n\t\t\t},\n\t\t\ttemplate: '<div ng-style=\"divStyle\"><label ng-style=\"labelStyle\"></label></div>'\n\t\t};\n\t}\n\n\tmapApi.$inject = ['$window','$q'];\n\tfunction mapApi($window, $q){\n\t\tvar deferred = $q.defer();\n\n\t\t// Load Google map API script\n\t\tfunction loadScript() {\n\t\t\t// Use global document since Angular's $document is weak\n\t\t\tvar script = document.createElement('script');\n\t\t\t// script.src = \"http://api.map.baidu.com/api?v=2.0&ak=您的密钥&callback=init\";\n\t\t\tscript.src = 'http://api.map.baidu.com/api?v=2.0&ak=CSFSaXio89D3WK1AB38sLNtnkV9fWZO4&callback=initMap';\n\t\t\tdocument.body.appendChild(script);\n\t\t}\n\n\t\t// Script loaded callback, send resolve\n\t\t$window.initMap = function () {\n\t\t\tdeferred.resolve();\n\t\t};\n\n\t\tloadScript();\n\t\treturn deferred.promise;\n\t}\n\n    \theatmapApi.$inject = ['$window','$q'];\n\tfunction heatmapApi($window, $q){\n\t\tvar deferred = $q.defer();\n\n\t\t// Load Google map API script\n\t\tfunction loadScript() {\n\t\t\t// Use global document since Angular's $document is weak\n\t\t\tvar script = document.createElement('script');\n\t\t\tscript.src = '';\n\t\t\tdocument.body.appendChild(script);\n\t\t}\n\n\t\t// Script loaded callback, send resolve\n\t\t$window.initMap = function () {\n\t\t\tdeferred.resolve();\n\t\t};\n\t\tloadScript();\n\t\treturn deferred.promise;\n\t}\n\n\tfunction moveMapToCenter(map, opts){\n\t\tvar points = [];\n\t\topts.boundary.forEach(function (loc) {\n\t\t\tpoints.push(new BMap.Point(loc.longitude, loc.latitude));\n\t\t});\n\t\tmap.setViewport(points);\n\t}\n\n\tfunction fullscreenControl(){\n\t\tthis.defaultAnchor = BMAP_ANCHOR_TOP_RIGHT;\n\t\tthis.defaultOffset = new BMap.Size(10, 10);\n\t}\n\n\tfunction toggleHeatMapButtons(){\n\t\tthis.defaultAnchor = BMAP_ANCHOR_TOP_RIGHT;\n\t\tthis.defaultOffset = new BMap.Size(50, 10);\n\t}\n\n\tfunction createHeatMapButtons(map, opts, element, $translate){\n\t\tif(opts.mapType===\"heatmap\"){\n\t\t\ttoggleHeatMapButtons.prototype = new BMap.Control();\n\t\t\ttoggleHeatMapButtons.prototype.initialize = function(map){\n\t\t\t\tvar div = document.createElement(\"div\");\n\t\t\t\tdiv.className = \"btn-group\";\n\t\t\t\tdiv.setAttribute(\"data-toggle\",\"buttons\");\n\n\t\t\t\t//first button\n\t\t\t\tvar labelHeatMap = document.createElement(\"label\");\n\t\t\t\tlabelHeatMap.className = \"btn btn-secondary btn-outline btn-sm active\";\n\t\t\t\tlabelHeatMap.setAttribute(\"for\",\"toggle_heatmap\");\n\t\t\t\tvar chkHeatMap = document.createElement(\"input\");\n\t\t\t\tchkHeatMap.type = \"checkbox\";\n\t\t\t\tchkHeatMap.setAttribute(\"name\",\"toggle_heatmap\");\n\t\t\t\tchkHeatMap.setAttribute(\"id\",\"toggle_heatmap\");\n\t\t\t\tchkHeatMap.setAttribute(\"checked\",\"checked\");\n\t\t\t\tlabelHeatMap.append(chkHeatMap);\n\t\t\t\tlabelHeatMap.innerHTML += $translate.instant('site_city_heatmap_toolbar_heatmap');\n\n\t\t\t\t//second button\n\t\t\t\tvar labelPipe = document.createElement(\"label\");\n\t\t\t\tlabelPipe.className = \"btn btn-secondary btn-outline btn-sm active\";\n\t\t\t\tlabelPipe.setAttribute(\"for\",\"toggle_pipe\");\n\t\t\t\tvar chkPipe = document.createElement(\"input\");\n\t\t\t\tchkPipe.type = \"checkbox\";\n\t\t\t\tchkPipe.setAttribute(\"name\",\"toggle_pipe\");\n\t\t\t\tchkPipe.setAttribute(\"id\",\"toggle_pipe\");\n\t\t\t\tchkPipe.setAttribute(\"checked\",\"checked\");\n\t\t\t\tlabelPipe.append(chkPipe);\n\t\t\t\tlabelPipe.innerHTML += $translate.instant('site_city_heatmap_toolbar_pipe');\n\n\t\t\t\t//third button\n\t\t\t\tvar labelMarker = document.createElement(\"label\");\n\t\t\t\tlabelMarker.className = \"btn btn-secondary btn-outline btn-sm active\";\n\t\t\t\tlabelMarker.setAttribute(\"for\",\"toggle_marker\");\n\t\t\t\tvar chkMarker = document.createElement(\"input\");\n\t\t\t\tchkMarker.type = \"checkbox\";\n\t\t\t\tchkMarker.setAttribute(\"name\",\"toggle_marker\");\n\t\t\t\tchkMarker.setAttribute(\"id\",\"toggle_marker\");\n\t\t\t\tchkMarker.setAttribute(\"checked\",\"checked\");\n\t\t\t\tlabelMarker.append(chkMarker);\n\t\t\t\tlabelMarker.innerHTML += $translate.instant('site_city_heatmap_toolbar_sensor');\n\n\t\t\t\tdiv.appendChild(labelHeatMap);\n\t\t\t\tdiv.appendChild(labelPipe);\n\t\t\t\tdiv.appendChild(labelMarker);\n\n\t\t\t\tlabelHeatMap.onchange = function(/*e*/){\n\t\t\t\t\tvar isOn = document.getElementById('toggle_heatmap').checked;\n\t\t\t\t\tif(typeof heatmapOverlay!==\"undefined\"){\n\t\t\t\t\t\tif(isOn){\n\t\t\t\t\t\t\theatmapOverlay.show();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\theatmapOverlay.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlabelPipe.onchange = function(/*e*/){\n\t\t\t\t\tvar isOn = document.getElementById('toggle_pipe').checked;\n\t\t\t\t\tvar allOverlay = map.getOverlays();\n\t\t\t\t\tfor (var i = 0; i < allOverlay.length -1; i++){\n\t\t\t\t\t\tif(allOverlay[i].toString()===\"[object Polyline]\"){\n\t\t\t\t\t\t\tif(isOn){\n\t\t\t\t\t\t\t\tallOverlay[i].show();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tallOverlay[i].hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tlabelMarker.onchange = function(/*e*/){\n\t\t\t\t\tvar isOn = document.getElementById('toggle_marker').checked;\n\t\t\t\t\tvar allOverlay = map.getOverlays();\n\t\t\t\t\tfor (var i = 0; i < allOverlay.length -1; i++){\n\t\t\t\t\t\tif(allOverlay[i].toString()===\"[object Marker]\"){\n\t\t\t\t\t\t\tif(isOn){\n\t\t\t\t\t\t\t\tallOverlay[i].show();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tallOverlay[i].hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// 添加DOM元素到地图中\n\t\t\t\tmap.getContainer().appendChild(div);\n\t\t\t\t// 将DOM元素返回\n\t\t\t\treturn div;\n\t\t\t};\n\t\t\t// 创建控件\n\t\t\tvar myCtrl = new toggleHeatMapButtons();\n\t\t\t// 添加到地图当中\n\t\t\tmap.addControl(myCtrl);\n\t\t}\n\t}\n\n\tfunction createFullScreen(map, opts, element){\n\t\tif(opts.fullScreen){\n\t\t\tfullscreenControl.prototype = new BMap.Control();\n\t\t\tfullscreenControl.prototype.initialize = function(map){\n\t\t\t\t// 创建一个DOM元素\n\t\t\t\tvar zoomBtn = document.createElement(\"div\");\n\t\t\t\tzoomBtn.className = \"btn waves-effect waves-light btn-secondary btn-sm\";\n\t\t\t\tvar zoomIcon = document.createElement(\"i\");\n\t\t\t\tzoomIcon.className = \"ti-fullscreen\";\n\t\t\t\t// 添加文字说明\n\t\t\t\tzoomBtn.appendChild(zoomIcon);\n\t\t\t\t// 绑定事件,点击一次放大两级\n\t\t\t\tzoomBtn.onclick = function(/*e*/){\n\t\t\t\t\t//map.setZoom(map.getZoom() + 2);\n\t\t\t\t\tif($(element).hasClass('map-fullscreen')){\n\t\t\t\t\t\t$(element).removeClass('map-fullscreen');\n\t\t\t\t\t\tzoomIcon.className = \"ti-fullscreen\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(element).addClass('map-fullscreen');\n\t\t\t\t\t\tzoomIcon.className = \"ti-back-left\";\n\t\t\t\t\t}\n\n\t\t\t\t};\n\t\t\t\t// 添加DOM元素到地图中\n\t\t\t\tmap.getContainer().appendChild(zoomBtn);\n\t\t\t\t// 将DOM元素返回\n\t\t\t\treturn zoomBtn;\n\t\t\t};\n\t\t\t// 创建控件\n\t\t\tvar myZoomCtrl = new fullscreenControl();\n\t\t\t// 添加到地图当中\n\t\t\tmap.addControl(myZoomCtrl);\n\t\t}\n\t}\n\n\tfunction createMapInstance(opts, element, $translate){\n\t\tvar map = new BMap.Map(element[0]);    // 创建Map实例\n\t\t/*\tbelow line will force map to be centralize based on this address\n\t\t*\twe will use boundary function to move map to center\n\t\t*/\n\t\tmap.centerAndZoom(new BMap.Point(opts.center.longitude, opts.center.latitude), opts.zoom);  // 初始化地图,设置中心点坐标和地图级别\n\t\t//map.addControl(new BMap.MapTypeControl({mapTypes: [BMAP_NORMAL_MAP]}));   //添加地图类型控件\n\t\tmap.addControl(new BMap.NavigationControl());   //add navigate control\n\t\tmap.setCurrentCity(opts.city);          // 设置地图显示的城市 此项是必须设置的\n\t\tmap.enableScrollWheelZoom(true);\n\t\tcreateFullScreen(map, opts, element);\n\t\tcreateHeatMapButtons(map, opts, element, $translate);\n\t\treturn map;\n\t}\n\n\tfunction createMarker(marker, point){\n\t\tif (marker.icon) {\n\t\t\tvar icon = new BMap.Icon(marker.icon, new BMap.Size(marker.width, marker.height),{\n\t\t\t\t anchor: new BMap.Size(15, marker.height),\n\t\t\t});\n\t\t\treturn new BMap.Marker(point, { icon: icon });\n\t\t}\n\t\treturn new BMap.Marker(point);\n\t}\n\n\t/* draw a pipe area line\n\t*\n\t*/\n\tfunction drawPipeArea(map, opts){\n\t\topts.pipes.forEach(function (row) {\n\t\t\tvar pipeArr = [];\n\t\t\trow.location.forEach(function (loc) {\n\t\t\t\tvar pt = new BMap.Point(loc.longitude, loc.latitude);\n\t\t\t\tpipeArr.push(pt);\n\n\t\t\t});\n\t\t\tvar pipeOverlay = new BMap.Polyline(pipeArr, {strokeColor: row.color, strokeWeight: row.weight, strokeOpacity:1});\n\t\t\tmap.addOverlay(pipeOverlay);\n\t\t});\n\t}\n\n\t/* draw a project area line\n\t*\n\t*/\n\tfunction boundaryArea(map, opts){\n\t\tvar points = [];\n\t\tvar num = Math.ceil(opts.boundary.length/2);\n\t\topts.boundary.forEach(function (loc) {\n\t\t\tpoints.push(new BMap.Point(loc.longitude, loc.latitude));\n\t\t});\n\t\tvar polygon = new BMap.Polygon(points, {strokeColor:\"blue\", strokeWeight:3, strokeOpacity:1, fillColor:\"\"});\n\t\tif(opts.boundary.length){\n\t\t\tmap.centerAndZoom(new BMap.Point(opts.boundary[num].longitude, opts.boundary[num].latitude), opts.zoom);\n\t\t}\n\t\tmap.addOverlay(polygon);\n\t\tmap.setViewport(points);\n\t\tmoveMapToCenter(map, opts);\n\t}\n\n\tfunction drawHeatMap(map, opts){\n\t\tif(!isSupportCanvas() || typeof map===\"undefined\"){\n\t\t\treturn false;\n\t\t}\n\t\tmap.removeEventListener(\"tilesloaded\", drawHeatMap); //remove listener\n\t\tvar radius = 150;\n\t\tvar max = 90;\n\t\theatmapOverlay = new BMapLib.HeatmapOverlay({\"radius\":radius});\n\t\tmap.addOverlay(heatmapOverlay);\n\t\theatmapOverlay.setDataSet({\n\t\t\tdata:opts.heatMap,\n\t\t\tmax:max\n\t\t});\n\t\theatmapOverlay.show();\n\t}\n\n\tfunction isSupportCanvas(){\n\t\tvar elem = document.createElement('canvas');\n\t\treturn !!(elem.getContext && elem.getContext('2d'));\n\t}\n\n\tfunction redrawMarkers(map, previousMarkers, opts, $scope, modalService){\n\t\tvar points = [];\n\t\tpreviousMarkers.forEach(function (item) {\n\t\t\tvar marker = item.marker;\n\t\t\tvar listener = item.listener;\n\n\t\t\tmarker.removeEventListener('click', listener);\n\t\t\tmap.removeOverlay(marker);\n\t\t});\n\t\tpreviousMarkers.length = 0;\n\t\tif (!opts.markers) {\n\t\t\treturn;\n\t\t}\n\n\t\topts.markers.forEach(function (marker) {\n\t\t\tvar markerItem = createMarker(marker, new BMap.Point(marker.longitude, marker.latitude));\n\t\t\tvar infoButton = \"<div class='btn-group'>\";\n\t\t\t\tinfoButton += \"<button type='button' class='btn btn-secondary' data-toggle='tooltip' data-trigger='hover' title='View Info' id='baidu_marker_info'><i class='ti-info-alt'></i></button>\";\n\t\t\t\tinfoButton += \"<button type='button' class='btn btn-secondary' data-toggle='tooltip' data-trigger='hover' title='View Data' id='baidu_marker_data'><i class='ti-stats-up'></i></button>\";\n\t\t\t\tinfoButton += \"</div>\";\n\t\t\tpoints.push(new BMap.Point(marker.longitude, marker.latitude));\n\n\t\t\t// add marker to the map\n\t\t\tmap.addOverlay(markerItem);\n\t\t\tmarkerItem.setLabel(\"\");\n\t\t\t// append marker\n\t\t\tvar previousMarker = { marker: markerItem, listener: null };\n\t\t\tpreviousMarkers.push(previousMarker);\n\t\t\tif (!marker.title && !marker.content) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//info window msg\n\t\t\tvar msg = '<p>' + (marker.title || '') + '</p><p>' + (marker.content || '') + '</p>';\n\t\t\tif(opts.mapType===\"map\"){\n\t\t\t\tmsg += infoButton;\n\t\t\t}\n\n\t\t\tvar infoWindowItem = new BMap.InfoWindow(msg, {\n\t\t\t\tenableMessage: !!marker.enableMessage\n\t\t\t});\n\t\t\t//marker binding\n\t\t\tpreviousMarker.listener = function () {\n\t\t\t\tthis.openInfoWindow(infoWindowItem);\n\t\t\t\tvar elData = document.getElementById(\"baidu_marker_data\");\n\t\t\t\tvar elInfo = document.getElementById(\"baidu_marker_info\");\n\t\t\t\tif(angular.isDefined(modalService)){\n\t\t\t\t\telData.addEventListener(\"click\", function(){\n\t\t\t\t\t\tmodalService.open(opts.modalUrl, opts.modalCtrl, marker);\n\t\t\t\t\t});\n\t\t\t\t\telInfo.addEventListener(\"click\", function(){\n\t\t\t\t\t\tmodalService.open(opts.modalUrlInfo, opts.modalCtrlInfo, marker);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\tmarkerItem.addEventListener('click', previousMarker.listener);\n\t\t\txpro.tooltips();\n\t\t});\n\t\tif(opts.mapType===\"heatmap\"){\n\t\t\tmap.setViewport(points);\n\t\t}\n\t}\n})();","/* global angular, BMap */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.factory', [])\n\t\t.factory('dialogService', dialogService)\n\t\t.factory('modalService', modalService);\n\n\tfunction dialogService($rootScope, $mdDialog) {\n\t\t\tvar dialogService = {};\n\t\t\t// create an array of alerts available globally\n\t\t\tdialogService.alert = function(ev, opts){\n\t\t\t\tvar config = {\n\t\t\t\t\ttitle: \"Information\",\n\t\t\t\t\tcontent : \"Something went wrong! Please try again\",\n\t\t\t\t\tok: \"Got It!\"\n\t\t\t\t};\n\t\t\t\tvar opt_config = angular.extend({}, config, opts);\n\t\t\t\t$mdDialog.show(\n\t\t\t\t\t$mdDialog.alert()\n\t\t\t\t\t.parent(angular.element(document.querySelector('#popupContainer')))\n\t\t\t\t\t\t.clickOutsideToClose(true)\n\t\t\t\t\t\t.title(opt_config.title)\n\t\t\t\t\t\t.textContent(opt_config.content)\n\t\t\t\t\t\t.ariaLabel(opt_config.title)\n\t\t\t\t\t\t.ok(opt_config.ok)\n\t\t\t\t\t\t.targetEvent(ev)\n\t\t\t\t);\n\t\t\t};\n\t\t\treturn dialogService;\n\t}\n\n\tfunction modalService($uibModal){\n\t\tvar vm = this;\n\t\tvar modalInstance;\n\t\treturn{\n\t\t\topen: function(url, ctrl, data){\n\t\t\t\tmodalInstance = $uibModal.open({\n\t\t\t\t\ttemplateUrl: url,\n\t\t\t\t\tcontroller: ctrl,\n\t\t\t\t\tsize: 'lg',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\titems: function () {\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tmodalInstance.result.then(function (selectedItem) {\n\t\t\t\t\tvm.selected = selectedItem;\n\t\t\t\t}, function () {\n\t\t\t\t\t//$log.info('Modal dismissed at: ' + new Date());\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n})();","/* global angular */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.filter', [])\n\t\t.filter('isObjectEmpty', isObjectEmpty)\n\t\t.filter('resourceUrl', resourceUrl);\n\n\tfunction isObjectEmpty(){\n\t\treturn function(object) {\n\t\t\treturn angular.equals({}, object);\n\t\t};\n\t}\n\n\tfunction resourceUrl($sce){\n\t\tvar version = __env.assetVersion;\n\t\treturn function(url) {\n\t\t\treturn $sce.trustAsResourceUrl(url+\"?version=\"+version);\n\t\t};\n\t}\n})();","/* global angular, __env */\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('xProject.auth', [])\n\t\t.controller('authLoginController', authLoginController);\n\n\tauthLoginController.$inject = ['$location', 'authService', 'dialogService','$translate'];\n\n\tfunction authLoginController($location, authService, dialogService, $translate) {\n\t\t/*jshint validthis: true */\n\t\tvar vm = this;\n\t\tvm.user = {};\n\t\tvm.onLogin = function() {\n\t\t\tauthService.login(vm.user)\n\t\t\t.then(function(user){\n\t\t\t\tif(angular.isDefined(user.data.token)){\n\t\t\t\t\tauthService.setAuthentication(user.data);\n\t\t\t\t\t$location.path(__env.pageMain);\n\t\t\t\t}else{\n\t\t\t\t\tdialogService.alert(null,{title: $translate.instant('site_login_error'), content: $translate.instant('site_login_info_invalid'), ok: $translate.instant('site_login_error_noted')});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(function(/*err*/){\n\t\t\t\tdialogService.alert(null,{title: $translate.instant('site_login_error'), content: $translate.instant('site_login_info_invalid'), ok: $translate.instant('site_login_error_noted')});\n\t\t\t});\n\t\t};\n\t}\n})();"]}